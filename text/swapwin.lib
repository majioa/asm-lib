SWAP_WINDOW	PROC	NEAR
;	ds:si - источник ( начало окна )
	PUSH	AX
	PUSH	BX
	PUSH	CX
	PUSH	DX
	PUSH	SI
	PUSH	DI
	PUSH	BP
	PUSH	DS
	PUSH	ES
	CLD
	LODSW
	PUSH	AX
	LODSW
	MOV	BX,AX
	LODSW
	MOV	CX,AX
	LODSW
	MOV	DX,AX
	MOV	AX,0B800H
	MOV	ES,AX
	POP	AX
	MOV	BP,DX
	MOV	DI,160
	MUL	DI
	MOV	DI,AX
	ROL	BX,1
	ADD	DI,BX
	PUSH	CX
SWAP_WINDOW_1:
	PUSH	CX
	PUSH	DI
	MOV	CX,BP
SWAP_WINDOW_2:
	LODSW
	XCHG	AX,ES:[DI]	
	MOV	DS:[SI-2],AX
	INC	DI
	INC	DI
	LOOP	SWAP_WINDOW_2
	POP	DI
	POP	CX
	ADD	DI,160
	LOOP	SWAP_WINDOW_1
	ADD	DI,4
	MOV	CX,BP
SWAP_WINDOW_3:
	LODSB
	XCHG	AL,ES:[DI+1]
	MOV	DS:[SI-1],AL
	INC	DI
	INC	DI
	LOOP	SWAP_WINDOW_3
	SUB	DI,160*2+4
	POP	CX
	DEC	CX
SWAP_WINDOW_4:
	PUSH	CX
	MOV	CX,2
SWAP_WINDOW_5:
	LODSB
	XCHG	AL,ES:[DI+1]
	MOV	DS:[SI-1],AL
	INC	DI
	INC	DI
	LOOP	SWAP_WINDOW_5
	POP	CX
	ADD	DI,160-4
	LOOP	SWAP_WINDOW_4
	POP	ES
	POP	DS
	POP	BP
	POP	DI
	POP	SI
	POP	DX
	POP	CX
	POP	BX
	POP	AX
	RET
SWAP_WINDOW	ENDP
